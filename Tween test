--// Configuração
local aimbotAtivo = true -- Ative por padrão para testar, troque para false se preferir
local teamCheckAtivo = true -- TeamCheck ativado por padrão

--// Função de TeamCheck
local function isEnemy(player)
    local localPlayer = game.Players.LocalPlayer
    if not teamCheckAtivo then return true end
    -- Se algum player não tem Team, não considera inimigo (altere para seu jogo se necessário)
    if not player.Team or not localPlayer.Team then return false end
    return player.Team ~= localPlayer.Team
end

--// Função para pegar o inimigo mais próximo do mouse
local uis = game:GetService("UserInputService")
local camera = workspace.CurrentCamera

local function getClosestEnemy()
    local closestPlayer = nil
    local shortestDistance = math.huge
    local mousePos = uis:GetMouseLocation()

    for _,player in ipairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and isEnemy(player) and player.Character and player.Character:FindFirstChild("Head") then
            local pos, onScreen = camera:WorldToViewportPoint(player.Character.Head.Position)
            if onScreen then
                local distance = (Vector2.new(pos.X, pos.Y) - Vector2.new(mousePos.X, mousePos.Y)).Magnitude
                if distance < shortestDistance then
                    shortestDistance = distance
                    closestPlayer = player
                end
            end
        end
    end
    return closestPlayer
end

--// Aimbot ao pressionar botão direito do mouse
uis.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.UserInputType == Enum.UserInputType.MouseButton2 and aimbotAtivo then
        local target = getClosestEnemy()
        if target and target.Character and target.Character:FindFirstChild("Head") then
            camera.CFrame = CFrame.new(camera.CFrame.Position, target.Character.Head.Position)
        end
    end
end)

--// ScreeGui setup
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Criar a ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AimbotGUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Frame principal
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 240, 0, 180)
mainFrame.Position = UDim2.new(0.5, -120, 0.5, -90)
mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
mainFrame.BorderSizePixel = 0
mainFrame.Visible = true
mainFrame.Parent = screenGui

-- Título
local title = Instance.new("TextLabel")
title.Text = "Aimbot Config"
title.Size = UDim2.new(1, 0, 0, 36)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255,255,255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 24
title.Parent = mainFrame

-- Botão de ativar/desativar aimbot
local aimbotBtn = Instance.new("TextButton")
aimbotBtn.Text = aimbotAtivo and "Aimbot: Ativado" or "Aimbot: Desativado"
aimbotBtn.Size = UDim2.new(0.8, 0, 0, 36)
aimbotBtn.Position = UDim2.new(0.1, 0, 0.25, 0)
aimbotBtn.BackgroundColor3 = Color3.fromRGB(50,120,50)
aimbotBtn.Font = Enum.Font.SourceSans
aimbotBtn.TextSize = 20
aimbotBtn.TextColor3 = Color3.fromRGB(255,255,255)
aimbotBtn.Parent = mainFrame

aimbotBtn.MouseButton1Click:Connect(function()
    aimbotAtivo = not aimbotAtivo
    aimbotBtn.Text = aimbotAtivo and "Aimbot: Ativado" or "Aimbot: Desativado"
    aimbotBtn.BackgroundColor3 = aimbotAtivo and Color3.fromRGB(50,120,50) or Color3.fromRGB(120,50,50)
end)

-- Botão de ativar/desativar team check
local teamCheckBtn = Instance.new("TextButton")
teamCheckBtn.Text = teamCheckAtivo and "TeamCheck: Ativado" or "TeamCheck: Desativado"
teamCheckBtn.Size = UDim2.new(0.8, 0, 0, 36)
teamCheckBtn.Position = UDim2.new(0.1, 0, 0.5, 0)
teamCheckBtn.BackgroundColor3 = Color3.fromRGB(50,120,200)
teamCheckBtn.Font = Enum.Font.SourceSans
teamCheckBtn.TextSize = 20
teamCheckBtn.TextColor3 = Color3.fromRGB(255,255,255)
teamCheckBtn.Parent = mainFrame

teamCheckBtn.MouseButton1Click:Connect(function()
    teamCheckAtivo = not teamCheckAtivo
    teamCheckBtn.Text = teamCheckAtivo and "TeamCheck: Ativado" or "TeamCheck: Desativado"
    teamCheckBtn.BackgroundColor3 = teamCheckAtivo and Color3.fromRGB(50,120,200) or Color3.fromRGB(120,120,120)
end)

-- Botão de fechar
local closeBtn = Instance.new("TextButton")
closeBtn.Text = "Fechar"
closeBtn.Size = UDim2.new(0.4, 0, 0, 32)
closeBtn.Position = UDim2.new(0.3, 0, 0.8, 0)
closeBtn.BackgroundColor3 = Color3.fromRGB(120,50,50)
closeBtn.Font = Enum.Font.SourceSans
closeBtn.TextSize = 18
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.Parent = mainFrame

closeBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
end)

-- Botão para abrir o menu (fica sempre na tela)
local openBtn = Instance.new("TextButton")
openBtn.Text = "Abrir Aimbot"
openBtn.Size = UDim2.new(0, 120, 0, 32)
openBtn.Position = UDim2.new(0, 10, 0.9, -40)
openBtn.BackgroundColor3 = Color3.fromRGB(30,120,200)
openBtn.Font = Enum.Font.SourceSans
openBtn.TextSize = 18
openBtn.TextColor3 = Color3.fromRGB(255,255,255)
openBtn.Parent = screenGui
openBtn.Visible = false

openBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = true
    openBtn.Visible = false
end)

mainFrame:GetPropertyChangedSignal("Visible"):Connect(function()
    openBtn.Visible = not mainFrame.Visible
end)

--// (Opcional) Atalho para ativar/desativar o aimbot (tecla "P")
uis.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.P then
        aimbotAtivo = not aimbotAtivo
        aimbotBtn.Text = aimbotAtivo and "Aimbot: Ativado" or "Aimbot: Desativado"
        aimbotBtn.BackgroundColor3 = aimbotAtivo and Color3.fromRGB(50,120,50) or Color3.fromRGB(120,50,50)
        print("Aimbot:", aimbotAtivo and "Ativado" or "Desativado")
    end
end)
